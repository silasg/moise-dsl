# This patch file was generated by NetBeans IDE
# It uses platform neutral UTF-8 encoding and \n newlines.
--- Base (BASE)
+++ Locally Modified (Based On LOCAL)
@@ -108,10 +108,14 @@
         return ele;
     }
     
-    
     public static OS loadOSFromURI(String uri) {
+        Document doc;
         try {
-            Document doc = DOMUtils.getParser().parse(uri);
+            if (uri.endsWith(".scala")) 
+                doc = readFromScalaDSLFile(uri);
+            else 
+                doc = DOMUtils.getParser().parse(uri);
+
             DOMUtils.getOSSchemaValidator().validate(new DOMSource(doc));
             
             OS os = new OS();
@@ -136,6 +140,31 @@
         return null;
     }
     
+    public static Document readFromScalaDSLFile(String uri) throws SAXException, IOException {
+        return loadXMLFrom(moise.dslinterpreter.MoiseInterpreter.interpret(uri));
+    }
+
+    private static Document loadXMLFrom(String xml)
+        throws org.xml.sax.SAXException, java.io.IOException {
+        return loadXMLFrom(new java.io.ByteArrayInputStream(xml.getBytes()));
+    }
+
+    private static Document loadXMLFrom(java.io.InputStream is)
+        throws org.xml.sax.SAXException, java.io.IOException {
+        javax.xml.parsers.DocumentBuilderFactory factory =
+            javax.xml.parsers.DocumentBuilderFactory.newInstance();
+        factory.setNamespaceAware(true);
+        javax.xml.parsers.DocumentBuilder builder = null;
+        try {
+            builder = factory.newDocumentBuilder();
+        }
+        catch (javax.xml.parsers.ParserConfigurationException ex) {
+        }
+        org.w3c.dom.Document doc = builder.parse(is);
+        is.close();
+        return doc;
+    }
+    
     /** the organisation-specification parent node is the parameter */
     public void setFromDOM(Node node) throws MoiseException {
         NodeList l = node.getChildNodes();
